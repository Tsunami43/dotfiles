# ────────────────────────────────
# Basic options
# ────────────────────────────────
set-option -g xterm-keys on
set -g default-terminal "screen-256color"
set -g mouse on

set -g history-limit 100000

# Indexing
set-option -g base-index 1
set-option -g pane-base-index 1

# ────────────────────────────────
# Status line
# ────────────────────────────────
set-option -g status-position bottom
set -g status-style "bg=default"
set -g status-interval 1
set -g status-justify left

set -g status-left "#[fg=#89b4fa] #S "
set -g status-right "#(date '+%H:%M:%S')   "

set -g window-status-separator "  "
set -g window-status-format "#[fg=#6c7086] #I: #{pane_current_command} "
set -g window-status-current-format "#[fg=#1e1e2e,bg=#89b4fa] #I: #{pane_current_command} "

set -g automatic-rename on

# ────────────────────────────────
# Reload configuration key
# ────────────────────────────────
bind r source-file ~/.config/tmux/tmux.conf \; display-message "tmux config reloaded!"

# ────────────────────────────────
# New session bind
# ────────────────────────────────
bind-key n run-shell "~/.config/tmux/new_session.sh"

# ────────────────────────────────
# Vi mode key bindings
# ────────────────────────────────
setw -g mode-keys vi
bind -T copy-mode-vi 'Escape' send -X cancel
bind-key t copy-mode

# Movement in copy-mode
bind-key -T copy-mode-vi 'h' send -X cursor-left
bind-key -T copy-mode-vi 'j' send -X cursor-down
bind-key -T copy-mode-vi 'k' send -X cursor-up
bind-key -T copy-mode-vi 'l' send -X cursor-right

# Selection in copy-mode
bind-key -T copy-mode-vi 'v' send -X begin-selection
bind-key -T copy-mode-vi 'y' send -X copy-selection-and-cancel
bind-key -T copy-mode-vi 'V' send -X select-line

# ────────────────────────────────
# Import external configs
# ────────────────────────────────
if-shell "uname -s | grep -q Darwin" "source ~/.config/tmux/macos.conf"
source ~/.config/tmux/theme.conf
source ~/.config/tmux/statusline.conf
source ~/.config/tmux/utility.conf

# ────────────────────────────────
# Plugins
# ────────────────────────────────
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-pain-control'

# ────────────────────────────────
# Automatic session naming hook
# ────────────────────────────────
# Список имен должен быть в ~/.config/tmux/session_names.txt
set-hook -g session-created 'run-shell "sleep 0.1; \
SESSION_NAME=$(shuf -n1 ~/.config/tmux/session_names.txt); \
tmux rename-session -t 0 \"$SESSION_NAME\" "'

